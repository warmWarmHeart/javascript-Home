#跨浏览器的开发技巧

> 先根据项目需求确认浏览器的等级

> 目标受众的期望和需要。浏览器的市场份额。浏览器支持所需的工作量。不应以牺牲质量赢取覆盖率。
## 可重用的跨浏览器开发涉及以下几个因素。
1. 代码体积——保持文件体积尽可能小。
2. 性能开销——以优秀作为最低性能标准。
3. API质量——保证不同浏览器上API一致性。
## 一. 开发五大问题：
	- 浏览器缺陷
	- 浏览器缺陷的修复：浏览器永远存在特定的错误是很愚蠢的——大部分浏览器bug最终
都会修复，把希望寄托在浏览器bug上是很危险的开发策略。
	- 外部代码和标记： 我们应尽可能少的引用全局变量。为了避免我们的代码影响页面上的其他代码，最佳实践是使用封装（JQuery）
	- 浏览器的回归:过去使用的特性不再运行了
	- 浏览器缺失的功能

当试图开发可复用的JavaScript代码，我们需要考虑所有的因素，还
需要考虑目前最流行的浏览器，因为这些浏览器是我们的目标受众最可
能使用的浏览器。其他不那么流行的浏览器，我们至少保证代码可以优
雅降级。例如，如果一个浏览器不支持某API，我们应该小心我们的代
码不会抛出任何异常，这样剩下的代码仍然可以顺利执行

## 二 实现策略
### A 安全的跨浏览器修复方法
* 最简单、最安全的跨浏览器修复方法有以下两个重要的特点
 - 在其他浏览器上没有副作用
 - 不使用浏览器或特性检测
* Jquery中的几个例子
> 将height或width样式属性设置为负数时，在IE的某一些版本中会抛
出异常，其他浏览器会直接忽略负数

    	if ((key == 'width' || key == 'height') && parseFloat(value) < 0)value = undefined;

> input元素的type属性本身作为DOM的一部分，在IE浏览器内部是不
允许修改的话，浏览器试图修改这个属性将抛出异常。jQuery给出中间
方案：在所有浏览器上都不允许所有试图修改input的注入属性，并抛出
统一的异常信息。

    if (name == "type" &&elem.nodeName.toLowerCase()== "input" &&elem.parentNode)throw "type attribute can't be changed";

**jQuery团队小心翼
翼地做出这种决定，认为一致的API、一致的行为，比开发跨浏览器代
码更重要。也许你遇到过类似的情况，记得，需要谨慎选择这种限制性
的方法，看它是否适合你的目标受众。**

### B 特性检测和垫片
>遗憾的是，只有支持ES6的浏览器可访问find方法。那么
在不支持ES6的浏览器中我们该如何操作呢？我们通常如何处理浏览器
缺失的特性呢？答案是垫片（polyfill）垫片是浏览器备用模式。如果浏览器不支持某一特定的功能，我们可以提供自己的实现。

* 例子

    	if (typeof document !== "undefined" &&
    		document.addEventListener &&
    		document.querySelector &&
    		document.querySelectorAll) {
    		// We have enough of an API to work with to build our application
    	}
    	else {
    	// Provide Fallback
    	}
* 我们检测浏览器是否加载文档  是否提供事件绑定方法 是否能基于选择器查找元素

* 当这些测试任意一项不通过， 我们就采用**备用方法**
	- 我们可以执行进一步的特征检测，找出如何使用一些JavaScript提供一个简版的体验
	- 我们可以选择不执行任何JavaScript，回到不用脚本的HTML页面
	- 我们可以将用户重定向到一个普通版网站。


### C 不可测试的浏览器问题
* 绑定事件处理器
* 事件的触发时机
* CSS属性的影响
* 浏览器的崩溃 （在老版本的Safari中使用Unicode字符创建正则表达式，将会导致浏览器崩溃）
* 不一致的API
* API性能

